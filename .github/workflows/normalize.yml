name: Normalize SRT

concurrency:
  group: normalize-srt
  cancel-in-progress: true

on:
  workflow_dispatch:
    inputs:
      srt_url:
        description: "Public URL to the SRT file"
        required: true
        type: string

jobs:
  normalize:
    runs-on: ubuntu-latest

    steps:
      - name: Install FFmpeg
        run: |
          sudo apt-get update
          sudo apt-get install -y ffmpeg

      - name: Download subtitle file
        run: |
          curl -L "${{ github.event.inputs.srt_url }}" -o input.ass

      - name: Show input file (debug)
        run: |
          ls -lh input.ass
          head -n 20 input.ass

      - name: Convert ASS to SRT
        run: |
          ffmpeg -y -i input.ass output.srt

      - name: Show output file (debug)
        run: |
          ls -lh output.srt
          head -n 20 output.srt
